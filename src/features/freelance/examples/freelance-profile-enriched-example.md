# Exemple de profil freelance enrichi

Ce document montre la nouvelle structure de r√©ponse pour l'endpoint `GET /freelances/:id` avec les √©valuations et missions r√©alis√©es.

## üìã Vue d'ensemble

L'endpoint `GET /freelances/:id` retourne maintenant un profil freelance enrichi avec :
- **Informations de base** du freelance
- **Comp√©tences** (skills) associ√©es
- **√âvaluations re√ßues** avec statistiques
- **Missions r√©alis√©es** (projets avec contrats termin√©s)

## üöÄ Utilisation

### Requ√™te
```bash
GET /freelances/123e4567-e89b-12d3-a456-426614174000
```

### R√©ponse enrichie compl√®te

```json
{
  "success": true,
  "data": {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "firstname": "Marie",
    "lastname": "Dubois",
    "email": "marie.dubois@example.com",
    "photo_url": "https://storage.example.com/profiles/marie.jpg",
    "job_title": "D√©veloppeuse Full Stack Senior",
    "experience": "expert",
    "description": "D√©veloppeuse passionn√©e avec 8 ans d'exp√©rience en d√©veloppement web et mobile...",
    "cover_url": "https://storage.example.com/covers/marie-cover.jpg",
    "linkedin_url": "https://linkedin.com/in/marie-dubois",
    "tjm": 650,
    "availability": "available",
    "location": "Paris, France",
    "is_verified": true,
    "country": "France",
    "city": "Paris",
    "phone": "+33 6 12 34 56 78",
    "block_duration": 0,
    "is_first_login": false,
    "deleted_at": null,
    "blocked_at": null,
    "created_at": "2023-01-15T10:30:00Z",
    "updated_at": "2024-01-10T14:20:00Z",
    "isBlocked": false,
    
    "skills": [
      {
        "id": "skill-uuid-1",
        "freelance_id": "123e4567-e89b-12d3-a456-426614174000",
        "skill_id": "react-uuid",
        "level": "expert",
        "created_at": "2023-01-15T10:30:00Z",
        "skill": {
          "id": "react-uuid",
          "name": "React.js",
          "description": "Biblioth√®que JavaScript pour cr√©er des interfaces utilisateur",
          "category_id": "frontend-uuid",
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": null
        }
      },
      {
        "id": "skill-uuid-2",
        "freelance_id": "123e4567-e89b-12d3-a456-426614174000",
        "skill_id": "nodejs-uuid",
        "level": "expert",
        "created_at": "2023-01-15T10:30:00Z",
        "skill": {
          "id": "nodejs-uuid",
          "name": "Node.js",
          "description": "Environnement d'ex√©cution JavaScript c√¥t√© serveur",
          "category_id": "backend-uuid",
          "created_at": "2023-01-01T00:00:00Z",
          "updated_at": null
        }
      }
    ],

    "evaluations": {
      "stats": {
        "user_id": "123e4567-e89b-12d3-a456-426614174000",
        "user_type": "freelance",
        "total_evaluations": 28,
        "average_rating": 4.7,
        "rating_distribution": {
          "rating_1": 0,
          "rating_2": 1,
          "rating_3": 2,
          "rating_4": 6,
          "rating_5": 19
        }
      },
      "recent": [
        {
          "id": "eval-uuid-1",
          "contract_id": "contract-uuid-1",
          "evaluator_id": "company-uuid-1",
          "evaluated_id": "123e4567-e89b-12d3-a456-426614174000",
          "evaluator_type": "company",
          "evaluated_type": "freelance",
          "rating": 5,
          "comment": "Excellent travail ! Marie a livr√© un code de qualit√©, dans les temps et avec une communication parfaite tout au long du projet.",
          "created_at": "2024-01-08T16:45:00Z",
          "updated_at": null,
          "contract": {
            "id": "contract-uuid-1",
            "project_id": "project-uuid-1",
            "project": {
              "id": "project-uuid-1",
              "title": "D√©veloppement API E-commerce"
            }
          },
          "evaluator": {
            "id": "company-uuid-1",
            "name": "TechCorp Solutions",
            "email": "contact@techcorp.com",
            "type": "company"
          }
        },
        {
          "id": "eval-uuid-2",
          "contract_id": "contract-uuid-2",
          "evaluator_id": "company-uuid-2",
          "evaluated_id": "123e4567-e89b-12d3-a456-426614174000",
          "evaluator_type": "company",
          "evaluated_type": "freelance",
          "rating": 4,
          "comment": "Tr√®s bon d√©veloppeur, quelques petits ajustements ont √©t√© n√©cessaires mais le r√©sultat final est excellent.",
          "created_at": "2023-12-20T11:30:00Z",
          "updated_at": null,
          "contract": {
            "id": "contract-uuid-2",
            "project_id": "project-uuid-2",
            "project": {
              "id": "project-uuid-2",
              "title": "Refonte Site Web Corporate"
            }
          },
          "evaluator": {
            "id": "company-uuid-2",
            "name": "Digital Agency Pro",
            "email": "hello@digitalagency.com",
            "type": "company"
          }
        }
      ],
      "total": 28
    },

    "completedMissions": [
      {
        "id": "contract-uuid-1",
        "project": {
          "id": "project-uuid-1",
          "title": "D√©veloppement API E-commerce",
          "description": "Cr√©ation d'une API REST compl√®te pour une plateforme e-commerce avec gestion des produits, commandes et paiements.",
          "budget": {
            "min": 8000,
            "max": 12000
          },
          "company": {
            "id": "company-uuid-1",
            "name": "TechCorp Solutions",
            "logo_url": "https://storage.example.com/logos/techcorp.png",
            "industry": "E-commerce"
          }
        },
        "contract": {
          "paymentMode": "fixed_price",
          "totalAmount": 10000,
          "tjm": null,
          "startDate": "2023-11-01T00:00:00Z",
          "endDate": "2024-01-05T00:00:00Z",
          "completedAt": "2024-01-08T16:45:00Z"
        }
      },
      {
        "id": "contract-uuid-2",
        "project": {
          "id": "project-uuid-2",
          "title": "Refonte Site Web Corporate",
          "description": "Modernisation compl√®te du site vitrine avec React et int√©gration CMS.",
          "budget": {
            "min": 5000,
            "max": 8000
          },
          "company": {
            "id": "company-uuid-2",
            "name": "Digital Agency Pro",
            "logo_url": "https://storage.example.com/logos/digital-agency.png",
            "industry": "Marketing Digital"
          }
        },
        "contract": {
          "paymentMode": "daily_rate",
          "totalAmount": null,
          "tjm": 600,
          "startDate": "2023-10-15T00:00:00Z",
          "endDate": "2023-12-15T00:00:00Z",
          "completedAt": "2023-12-20T11:30:00Z"
        }
      },
      {
        "id": "contract-uuid-3",
        "project": {
          "id": "project-uuid-3",
          "title": "Application Mobile de Fitness",
          "description": "D√©veloppement d'une app mobile React Native pour le suivi d'activit√©s sportives.",
          "budget": {
            "min": 15000,
            "max": 20000
          },
          "company": {
            "id": "company-uuid-3",
            "name": "FitLife Technologies",
            "logo_url": "https://storage.example.com/logos/fitlife.png",
            "industry": "Sant√© & Fitness"
          }
        },
        "contract": {
          "paymentMode": "by_milestone",
          "totalAmount": 18000,
          "tjm": null,
          "startDate": "2023-07-01T00:00:00Z",
          "endDate": "2023-10-01T00:00:00Z",
          "completedAt": "2023-10-05T09:30:00Z"
        }
      }
    ]
  },
  "message": "Freelance r√©cup√©r√© avec succ√®s"
}
```

## üìä Nouvelles donn√©es disponibles

### 1. Statistiques d'√©valuations
```json
"evaluations": {
  "stats": {
    "total_evaluations": 28,      // Nombre total d'√©valuations re√ßues
    "average_rating": 4.7,        // Note moyenne sur 5
    "rating_distribution": {      // R√©partition des notes
      "rating_1": 0,
      "rating_2": 1,
      "rating_3": 2,
      "rating_4": 6,
      "rating_5": 19
    }
  }
}
```

### 2. √âvaluations r√©centes
```json
"evaluations": {
  "recent": [                     // 10 √©valuations les plus r√©centes
    {
      "rating": 5,
      "comment": "Excellent travail !",
      "evaluator": {
        "name": "TechCorp Solutions",
        "type": "company"
      },
      "contract": {
        "project": {
          "title": "D√©veloppement API E-commerce"
        }
      }
    }
  ],
  "total": 28                     // Nombre total pour pagination
}
```

### 3. Missions r√©alis√©es
```json
"completedMissions": [
  {
    "project": {
      "title": "D√©veloppement API E-commerce",
      "description": "Cr√©ation d'une API REST compl√®te...",
      "budget": { "min": 8000, "max": 12000 }
    },
    "contract": {
      "paymentMode": "fixed_price",
      "totalAmount": 10000,
      "startDate": "2023-11-01T00:00:00Z",
      "endDate": "2024-01-05T00:00:00Z"
    }
  }
]
```

## üí° Cas d'utilisation

### 1. Affichage du profil public
```typescript
const freelanceProfile = await getFreelanceById(freelanceId);

// Afficher les stats d'√©valuation
const { stats } = freelanceProfile.evaluations;
console.log(`Note moyenne: ${stats.average_rating}/5`);
console.log(`${stats.total_evaluations} √©valuations`);

// Afficher les derni√®res √©valuations
freelanceProfile.evaluations.recent.forEach(eval => {
  console.log(`${eval.rating}/5 - ${eval.comment}`);
});

// Afficher l'exp√©rience
console.log(`${freelanceProfile.completedMissions.length} missions r√©alis√©es`);
```

### 2. Calcul de cr√©dibilit√©
```typescript
function calculateCredibilityScore(freelance) {
  const { stats } = freelance.evaluations;
  const missionCount = freelance.completedMissions.length;
  
  // Score bas√© sur les √©valuations et missions
  const ratingScore = stats.average_rating * 20; // Max 100
  const experienceScore = Math.min(missionCount * 5, 50); // Max 50
  
  return Math.round(ratingScore + experienceScore);
}
```

### 3. Filtrage par performance
```typescript
function getTopPerformers(freelances) {
  return freelances.filter(freelance => {
    const { stats } = freelance.evaluations;
    return stats.average_rating >= 4.5 && 
           stats.total_evaluations >= 10 &&
           freelance.completedMissions.length >= 5;
  });
}
```

## üîç Informations techniques

### Performance
- **√âvaluations** : Limit√©es √† 10 r√©centes pour √©viter la surcharge
- **Missions** : Limit√©es √† 50 contrats termin√©s maximum
- **Requ√™tes optimis√©es** : Une requ√™te principale + requ√™tes cibl√©es pour les donn√©es enrichies

### Gestion des erreurs
- Si les √©valuations √©chouent, le profil est retourn√© sans cette section
- Si les missions √©chouent, un tableau vide est retourn√©
- Les erreurs sont logg√©es mais n'interrompent pas la r√©ponse principale

### √âvolutivit√©
- Possibilit√© d'ajouter la pagination pour les √©valuations compl√®tes
- Possibilit√© d'ajouter des filtres pour les missions (par p√©riode, montant, etc.)
- Cache possible sur les statistiques d'√©valuation

## üìà M√©triques disponibles

Le profil enrichi permet de calculer :
- **Taux de satisfaction** : % d'√©valuations 4-5 √©toiles
- **Exp√©rience projet** : Nombre et types de missions
- **Valeur moyenne** : TJM moyen des contrats termin√©s
- **Fiabilit√©** : R√©gularit√© des bonnes √©valuations
- **Sp√©cialisation** : Types de projets les plus fr√©quents

---

**Version :** 1.0  
**Derni√®re mise √† jour :** Janvier 2024  
**Auteur :** √âquipe Synkrone Backend